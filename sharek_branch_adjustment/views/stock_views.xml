<odoo>
	<data>

		<record id="view_picking_form" model="ir.ui.view">
            <field name="name">stock.picking.form</field>
            <field name="model">stock.picking</field>
			<field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
				<xpath expr="//field[@name='picking_type_id']" position="attributes">
					<attribute name="domain">context.get('restricted_picking_type_code') and [('code', '=', context.get('restricted_picking_type_code'))] or [(1,'=',1)]</attribute>
				</xpath>
				<xpath expr="//field[@name='owner_id']" position="after">
					<field name="adjustment" widget="boolean_toggle" invisible="adjustment != True" readonly="1" force_save="1"/>
				</xpath>
				<xpath expr="//field[@name='move_ids_without_package']/list/field[@name='product_uom_qty']" position="before">
					<field name="onhand_qty" column_invisible="parent.adjustment != True"/>
					<field name="count_qty" column_invisible="parent.adjustment != True"/>
					<field name="adjustment" invisible="1"/>
				</xpath>
				<xpath expr="//header" position="inside">
					<button name="update_adjustment_moves" type="object" string="Update Moves" class="oe_highlight"
                            invisible="adjustment != True or state == 'done'"/>
				</xpath>
			</field>
		</record>
		
		<record id="action_picking_adjustment" model="ir.actions.act_window">
            <field name="name">Branch Adjustment</field>
            <field name="res_model">stock.picking</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">list,kanban,form,calendar</field>
            <field name="domain">[('adjustment','=',True)]</field>
            <field name="context">{'contact_display': 'partner_address', 
			'default_company_id': allowed_company_ids[0], 'default_adjustment':1, 'restricted_picking_type_code':'outgoing'}</field>
            <field name="search_view_id" ref="stock.view_picking_internal_search"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No transfer found. Let's create one!
                </p>
            </field>
        </record>

		<menuitem name="Branch Adjustment" id="menu_branch_adjustment_root" sequence="140"
        web_icon="sharek_branch_adjustment,static/description/icon.png"/>
		<menuitem name="Branch Adjustment" id="menu_branch_adjustment" parent="menu_branch_adjustment_root"
		action="action_picking_adjustment" />

		<record id="view_picking_move_adjustment_tree" model="ir.ui.view">
            <field name="name">stock.picking.move.tree</field>
            <field name="model">stock.move</field>
			<field name="inherit_id" ref="stock.view_picking_move_tree"/>
			<field name="mode">primary</field>
            <field name="arch" type="xml">
				<xpath expr="//field[@name='product_uom_qty']" position="before">
					<field name="onhand_qty"/>
					<field name="count_qty"/>
					<field name="adjustment" invisible="1"/>
				</xpath>
			</field>
		</record>

		

	</data>
</odoo>